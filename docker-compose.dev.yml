version: '3.9'

# Development environment override
services:
  backend:
    build:
      target: base
    environment:
      APP_ENV: local
      APP_DEBUG: true
    volumes:
      - ./backend:/var/www:cached
    command: php artisan serve --host=0.0.0.0 --port=8000

  frontend:
    build:
      target: development
    environment:
      NODE_ENV: development
      NEXT_PUBLIC_API_URL: http://localhost:8000/api
    volumes:
      - ./frontend:/app:cached
      - /app/node_modules
      - /app/.next
    command: npm run dev

  queue:
    environment:
      APP_ENV: local
      APP_DEBUG: true
    volumes:
      - ./backend:/var/www:cached

  scheduler:
    environment:
      APP_ENV: local
      APP_DEBUG: true
    volumes:
      - ./backend:/var/www:cached

  # Additional development tools
  adminer:
    image: adminer:latest
    container_name: renthub-adminer
    restart: unless-stopped
    ports:
      - "8080:8080"
    environment:
      ADMINER_DEFAULT_SERVER: postgres
    networks:
      - renthub-network

  redis-commander:
    image: rediscommander/redis-commander:latest
    container_name: renthub-redis-commander
    restart: unless-stopped
    environment:
      REDIS_HOSTS: local:redis:6379:0:${REDIS_PASSWORD:-secret}
    ports:
      - "8081:8081"
    networks:
      - renthub-network
